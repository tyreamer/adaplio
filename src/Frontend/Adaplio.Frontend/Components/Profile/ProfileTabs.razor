@using Adaplio.Frontend.Services
@using Adaplio.Frontend.Components.Common
@inject AuthStateService AuthState
@inject AuthorizationService Authorization
@inject ISnackbar Snackbar

<div class="modern-profile-tabs">
    <!-- Modern Tab Navigation -->
    <div class="tab-navigation">
        <div class="tab-nav-container">
            <button class="tab-button @(_activeTab == 0 ? "active" : "")" @onclick="@(() => SetActiveTab(0))">
                <MudIcon Icon="@Icons.Material.Filled.Dashboard" Size="Size.Small" />
                <span class="tab-text">Overview</span>
            </button>
            <button class="tab-button @(_activeTab == 1 ? "active" : "")" @onclick="@(() => SetActiveTab(1))">
                <MudIcon Icon="@Icons.Material.Filled.Assignment" Size="Size.Small" />
                <span class="tab-text">Plans</span>
            </button>
            <button class="tab-button @(_activeTab == 2 ? "active" : "")" @onclick="@(() => SetActiveTab(2))">
                <MudIcon Icon="@Icons.Material.Filled.TrendingUp" Size="Size.Small" />
                <span class="tab-text">Progress</span>
            </button>
            <button class="tab-button @(_activeTab == 3 ? "active" : "")" @onclick="@(() => SetActiveTab(3))">
                <MudIcon Icon="@Icons.Material.Filled.Settings" Size="Size.Small" />
                <span class="tab-text">Settings</span>
            </button>
        </div>
    </div>

    <!-- Tab Content -->
    <div class="tab-content-area">
        <!-- Overview Tab -->
        @if (_activeTab == 0)
        {
            <div class="tab-panel">
                <OverviewTabContent />
            </div>
        }

        <!-- Plans Tab -->
        @if (_activeTab == 1)
        {
            <div class="tab-panel">
                <PlansTabContent />
            </div>
        }

        <!-- Progress Tab -->
        @if (_activeTab == 2)
        {
            <div class="tab-panel">
                <ProgressTabContent />
            </div>
        }

        <!-- Settings Tab -->
        @if (_activeTab == 3)
        {
            <div class="tab-panel">
                @if (AuthState.IsClient)
                {
                    <ClientProfileForm />
                }
                else if (AuthState.IsTrainer)
                {
                    <TrainerProfileForm />
                }
                else
                {
                    <MudAlert Severity="Severity.Error">
                        You don't have permission to edit your profile.
                    </MudAlert>
                }
            </div>
        }
    </div>
</div>


@code {
    private int _activeTab = 0;

    private void SetActiveTab(int tabIndex)
    {
        _activeTab = tabIndex;
    }
}