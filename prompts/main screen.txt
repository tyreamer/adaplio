Goal: Implement role-based post-login landing views and role-gated navigation for â€œAdaplioâ€ PT adherence app. Users are either Client or Trainer. Some accounts may toggle a local â€œview modeâ€ for demo (â€œIâ€™m a Clientâ€ / â€œStart as Trainerâ€), but the server role is the source of truth for gating.

Deliverables

RoleGate component + route protection

Two landing pages:

Pages/HomeClient.razor (default for Clients)

Pages/HomeTrainer.razor (default for Trainers)

Role-aware Shared/NavMenu.razor (hide irrelevant links).

Empty states, skeletons, and error banners for 401/403.

Minimal services to fetch data shapes below.

UX & Behavior
A) Client landing (/home when role=client)

Header row: â€œThis Weekâ€, chips: Streak (ğŸ”¥xN), XP meter (progress), Todayâ€™s date (tz-aware).

Section â€œMissionsâ€ (today/this week):

Card fields: exercise name, setsÃ—reps or hold (e.g., â€œ3Ã—12â€ or â€œ3Ã—30sâ€), target day chips, Start (navigates to log panel), Done (posts quick completion).

Support right/left side indication; show a subtle â€œdue todayâ€ marker.

Panel â€œPending Proposalsâ€ (badge count). Clicking opens a drawer with rows:

For each item: name, prescription, Accept / Decline / Ask to swap.

Panel â€œBadges & Rewardsâ€ (grid of earned/locked).

Panel â€œMy Trainersâ€:

List: Trainer display name (or org), scope chip: Summary or Private; Manage opens a dialog:

Toggle scope (enable/disable view_summary), Revoke access.

Empty states:

No missions â†’ CTA: â€œPaste Grant Code from your trainerâ€ with input â†’ POST accept grant.

B) Trainer landing (/home when role=trainer)

Header: Clients Overview with quick filters (All / Summary shared / Private).

Clients Table (MudTable):

Columns: Alias | Scope (chip) | Adherence % (last 7 days) | Last activity (relative) | Actions (View Summary, New Proposal).

Right rail:

New Proposal (primary button)

Templates (manage)

Upload Video â†’ Transcribe â†’ Extract (opens media wizard)

Panels:

Recent Proposals (status chips: Sent / Partially accepted / Declined)

Notifications (declines, scope changes)

Empty states:

No clients â†’ â€œSend Inviteâ€ button (copies Grant Link/Code)

Navigation (show/hide)

Client: Home, Weekly Board, Proposals, Progress, Rewards, Trainers, Settings

Trainer: Home, Dashboard, Templates, Proposals, Clients, Settings
(If you keep a mode toggle for demos, add a Mode switch in the user menu; otherwise drive from server claim.)

Components & Files

Shared/RoleGate.razor: wraps content; reads AuthState and UserRole. If unauthorized â†’ show Login link. If 403 for a page â†’ friendly message + back to Home.

Pages/HomeClient.razor, Pages/HomeTrainer.razor: implement layouts above using MudPaper/MudCard/MudChip/MudProgressCircular.

Shared/NavMenu.razor: computes visible items based on role; highlights current; mobile collapsible.

Services/ApiClient.cs: strongly-typed calls.

Visual details

Use Mud themes; keep plenty of whitespace; card radius 2xl, subtle shadows.

Chips: Summary (filled) vs Private (outlined).

XP meter: MudProgressLinear; Streak as MudChip with icon.

Skeleton loaders on first fetch; optimistic UI for Accept/Decline with rollback on error.

Route protection & role detection

Read role claim from auth token (role: client|trainer). Expose via AuthState service.

App.razor routes:

@page "/home": <RoleGate Client><HomeClient/></RoleGate> and <RoleGate Trainer><HomeTrainer/></RoleGate>; or redirect to the correct one based on role.

Guard trainer-only pages (Templates, Clients, New Proposal) with RoleGate; show 403 panel otherwise.

Empty states & errors

401 â†’ banner: â€œYour session expired. Sign in again.â€ + login button.

403 â†’ banner: â€œYou donâ€™t have access to this page in your current role.â€

No missions/proposals/clients â†’ friendly illustration + CTA.

Acceptance criteria

Logging in as Client lands on Weekly Board with missions; proposals and badges visible; trainer scope management works (toggle + revoke).

Logging in as Trainer lands on Clients Overview; can create a new proposal stub.

Nav only shows pages for that role; deep-links to other role pages show a 403 panel.

All lists have skeletons; actions are optimistic; errors show non-blocking snackbars.

Quick improvement suggestions

Default to role landing (not a generic â€œWelcomeâ€). Ship /home â†’ role redirect.

Hide 404/401 spam: gate calls until the role is known; show skeletons.

Use a compact topbar with a role badge and a clear Invite Client (trainer) / Add Trainer (client).

Add search & filters on the Trainer Clients table (Summary shared vs Private).

Mobile first: bottom tab bar for Client (Home/Board/Progress/Rewards) so it feels app-y.